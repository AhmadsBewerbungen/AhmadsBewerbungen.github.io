<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Retro Noob â€“ Iconic</title>
<style>
  body {
    margin: 0;
    background: #0b0e1a;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  canvas {
    image-rendering: pixelated;
    border: 6px solid #0b0e1a;
    background: #000;
    box-shadow: 0 0 40px #000;
  }
</style>
</head>
<body>

<canvas id="game" width="320" height="180"></canvas>

<script>
/* =====================
   SETUP
===================== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const SCALE = 3;
canvas.style.width = canvas.width * SCALE + "px";
canvas.style.height = canvas.height * SCALE + "px";

const GROUND_Y = 140;
const GRAVITY = 0.35;

const keys = {};
addEventListener("keydown", e => keys[e.key] = true);
addEventListener("keyup", e => keys[e.key] = false);

/* =====================
   CAMERA
===================== */
const camera = { x: 0 };

/* =====================
   PLAYER
===================== */
const player = {
  x: 40,
  y: GROUND_Y,
  vx: 0,
  vy: 0,
  w: 24,
  h: 28,
  facing: 1,
  state: "idle",
  frame: 0,
  frameTimer: 0
};

const animations = {
  idle: { frames: 6, fps: 8 },
  run:  { frames: 6, fps: 18 },
  jump: { frames: 1, fps: 1 }
};

/* =====================
   PARTICLES
===================== */
const dust = [];

function spawnDust(x, y) {
  dust.push({
    x, y,
    vx: Math.random() * -0.5,
    life: 20
  });
}

/* =====================
   BACKGROUND
===================== */
const clouds = [
  { x: 20, y: 24 },
  { x: 140, y: 38 },
  { x: 260, y: 20 }
];

const trees = [
  { x: 80 },
  { x: 180 },
  { x: 300 }
];

/* =====================
   DRAW PLAYER
===================== */
function drawNoob(frame) {
  const px = Math.floor(player.x - camera.x);
  const py = Math.floor(player.y - player.h);

  const bob =
    player.state === "idle" ? Math.sin(frame * 0.6) * 1 :
    player.state === "run"  ? Math.sin(frame) * 2 : 0;

  const swing =
    player.state === "run" ? Math.sin(frame) * 3 : 0;

  // shadow
  ctx.fillStyle = "rgba(0,0,0,0.3)";
  ctx.fillRect(px + 6, GROUND_Y + 2, 12, 3);

  ctx.save();
  ctx.translate(px + player.w / 2, 0);
  ctx.scale(player.facing, 1);
  ctx.translate(-px - player.w / 2, 0);

  // outline body
  ctx.fillStyle = "#000";
  ctx.fillRect(px + 2, py - 6 + bob, 20, 26);

  // head
  ctx.fillStyle = "#ffd93b";
  ctx.fillRect(px + 4, py - 4 + bob, 16, 16);

  // face
  ctx.fillStyle = "#000";
  ctx.fillRect(px + 8, py + 2 + bob, 2, 2);
  ctx.fillRect(px + 14, py + 2 + bob, 2, 2);
  ctx.fillRect(px + 9, py + 7 + bob, 6, 1);

  // body
  ctx.fillStyle = "#2f6bff";
  ctx.fillRect(px + 8, py + 12, 8, 8);

  // arms
  ctx.fillStyle = "#ffd93b";
  ctx.fillRect(px + 4, py + 12 + swing, 3, 6);
  ctx.fillRect(px + 17, py + 12 - swing, 3, 6);

  // legs
  ctx.fillStyle = "#222";
  ctx.fillRect(px + 9, py + 20 + swing, 3, 6);
  ctx.fillRect(px + 12, py + 20 - swing, 3, 6);

  ctx.restore();
}

/* =====================
   WORLD
===================== */
function drawSky() {
  ctx.fillStyle = "#7ecbff";
  ctx.fillRect(0, 0, canvas.width, GROUND_Y);

  // sun
  ctx.fillStyle = "#ffd93b";
  ctx.fillRect(240 - camera.x * 0.2, 20, 24, 24);

  // hills
  ctx.fillStyle = "#6bbf6b";
  ctx.fillRect(0 - camera.x * 0.3, 100, 400, 40);
}

function drawGrass() {
  ctx.fillStyle = "#2f8f2f";
  ctx.fillRect(0, GROUND_Y, canvas.width, 40);

  ctx.fillStyle = "#1f6f1f";
  for (let i = 0; i < canvas.width; i += 2) {
    ctx.fillRect(i, GROUND_Y - 2, 1, 2);
  }
}

function drawCloud(c) {
  const x = c.x - camera.x * 0.25;
  ctx.fillStyle = "#fff";
  ctx.fillRect(x, c.y, 20, 6);
  ctx.fillRect(x + 4, c.y - 4, 12, 6);
}

function drawTree(t) {
  const x = t.x - camera.x * 0.6;
  ctx.fillStyle = "#6b3e26";
  ctx.fillRect(x + 6, GROUND_Y - 18, 4, 18);
  ctx.fillStyle = "#2e8b57";
  ctx.fillRect(x - 6, GROUND_Y - 32, 28, 14);
}

/* =====================
   UPDATE
===================== */
function update(dt) {
  player.vx = 0;

  if (keys["ArrowLeft"] || keys["a"]) {
    player.vx = -1.6;
    player.facing = -1;
  }
  if (keys["ArrowRight"] || keys["d"]) {
    player.vx = 1.6;
    player.facing = 1;
  }

  if ((keys[" "] || keys["ArrowUp"]) && player.vy === 0) {
    player.vy = -5.5;
  }

  player.vy += GRAVITY;
  player.x += player.vx;
  player.y += player.vy;

  if (player.y > GROUND_Y) {
    if (player.vx !== 0) spawnDust(player.x, GROUND_Y);
    player.y = GROUND_Y;
    player.vy = 0;
  }

  player.state =
    player.vy !== 0 ? "jump" :
    player.vx !== 0 ? "run" : "idle";

  const anim = animations[player.state];
  player.frameTimer += dt;
  if (player.frameTimer >= 1000 / anim.fps) {
    player.frame = (player.frame + 1) % anim.frames;
    player.frameTimer = 0;
  }

  camera.x = player.x - 80;

  dust.forEach(p => {
    p.x += p.vx;
    p.life--;
  });
}

/* =====================
   DRAW
===================== */
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawSky();
  clouds.forEach(drawCloud);
  trees.forEach(drawTree);
  drawGrass();

  dust.forEach(p => {
    ctx.fillStyle = "#999";
    ctx.fillRect(p.x - camera.x, p.y - 2, 2, 2);
  });

  drawNoob(player.frame);
}

/* =====================
   LOOP
===================== */
let last = 0;
function loop(t) {
  const dt = t - last;
  last = t;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);
</script>

</body>
</html>
