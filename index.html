<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Retro Noob (Polished)</title>
<style>
  body {
    margin: 0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  canvas {
    image-rendering: pixelated;
    border: 4px solid #111;
    background: #000;
  }
</style>
</head>
<body>

<canvas id="game" width="320" height="180"></canvas>

<script>
/* =====================
   SETUP
===================== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const SCALE = 3;
canvas.style.width = canvas.width * SCALE + "px";
canvas.style.height = canvas.height * SCALE + "px";

const GROUND_Y = 140;
const GRAVITY = 0.35;

const keys = {};
addEventListener("keydown", e => keys[e.key] = true);
addEventListener("keyup", e => keys[e.key] = false);

/* =====================
   CAMERA
===================== */
const camera = { x: 0 };

/* =====================
   PLAYER
===================== */
const player = {
  x: 40,
  y: GROUND_Y,
  vx: 0,
  vy: 0,
  w: 24,
  h: 26,
  facing: 1,
  state: "idle",
  frame: 0,
  frameTimer: 0
};

const animations = {
  idle: { frames: 6, fps: 10 },
  run:  { frames: 6, fps: 16 },
  jump: { frames: 1, fps: 1 }
};

/* =====================
   BACKGROUND
===================== */
const clouds = [
  { x: 20, y: 22 },
  { x: 120, y: 34 },
  { x: 220, y: 18 }
];

const trees = [
  { x: 60 },
  { x: 140 },
  { x: 220 },
  { x: 300 }
];

/* =====================
   DRAW PLAYER
===================== */
function drawNoob(frame) {
  const px = Math.floor(player.x - camera.x);
  const py = Math.floor(player.y - player.h);

  const bob =
    player.state === "idle" ? Math.sin(frame * 0.6) * 1 :
    player.state === "run"  ? Math.sin(frame) * 1.5 : 0;

  const swing =
    player.state === "run" ? Math.sin(frame) * 2 : 0;

  // shadow
  ctx.fillStyle = "rgba(0,0,0,0.25)";
  ctx.fillRect(px + 6, GROUND_Y + 2, 12, 3);

  ctx.save();
  ctx.translate(px + player.w / 2, 0);
  ctx.scale(player.facing, 1);
  ctx.translate(-px - player.w / 2, 0);

  // head
  ctx.fillStyle = "#ffde3b";
  ctx.fillRect(px + 3, py - 4 + bob, 18, 18);
  ctx.strokeStyle = "#000";
  ctx.strokeRect(px + 3, py - 4 + bob, 18, 18);

  // face
  ctx.fillStyle = "#000";
  ctx.fillRect(px + 8, py + 4 + bob, 2, 2);
  ctx.fillRect(px + 14, py + 4 + bob, 2, 2);
  ctx.fillRect(px + 9, py + 9 + bob, 6, 1);

  // body
  ctx.fillStyle = "#1e90ff";
  ctx.fillRect(px + 8, py + 14, 8, 7);
  ctx.strokeRect(px + 8, py + 14, 8, 7);

  // arms
  ctx.fillStyle = "#ffde3b";
  ctx.fillRect(px + 4, py + 14 + swing, 3, 6);
  ctx.fillRect(px + 17, py + 14 - swing, 3, 6);

  // legs
  ctx.fillStyle = "#111";
  ctx.fillRect(px + 9, py + 21 + swing, 3, 5);
  ctx.fillRect(px + 12, py + 21 - swing, 3, 5);

  ctx.restore();
}

/* =====================
   WORLD
===================== */
function drawSky() {
  const g = ctx.createLinearGradient(0, 0, 0, GROUND_Y);
  g.addColorStop(0, "#7ecbff");
  g.addColorStop(1, "#bfe9ff");
  ctx.fillStyle = g;
  ctx.fillRect(0, 0, canvas.width, GROUND_Y);
}

function drawGrass() {
  ctx.fillStyle = "#2f8f2f";
  ctx.fillRect(0, GROUND_Y, canvas.width, 40);

  ctx.fillStyle = "#267326";
  for (let i = 0; i < canvas.width; i += 3) {
    ctx.fillRect(i, GROUND_Y - 2, 1, 2);
  }
}

function drawCloud(c) {
  const x = c.x - camera.x * 0.25;
  ctx.fillStyle = "#fff";
  ctx.fillRect(x, c.y, 18, 6);
  ctx.fillRect(x + 4, c.y - 4, 12, 6);
}

function drawTree(t) {
  const x = t.x - camera.x * 0.6;
  ctx.fillStyle = "#7a3e1d";
  ctx.fillRect(x + 6, GROUND_Y - 16, 4, 16);
  ctx.fillStyle = "#2e8b57";
  ctx.fillRect(x - 2, GROUND_Y - 28, 20, 12);
}

/* =====================
   UPDATE
===================== */
function update(dt) {
  player.vx = 0;

  if (keys["ArrowLeft"] || keys["a"]) {
    player.vx = -1.6;
    player.facing = -1;
  }
  if (keys["ArrowRight"] || keys["d"]) {
    player.vx = 1.6;
    player.facing = 1;
  }

  if ((keys[" "] || keys["ArrowUp"]) && player.vy === 0) {
    player.vy = -5.5;
  }

  player.vy += GRAVITY;
  player.x += player.vx;
  player.y += player.vy;

  if (player.y > GROUND_Y) {
    player.y = GROUND_Y;
    player.vy = 0;
  }

  player.state =
    player.vy !== 0 ? "jump" :
    player.vx !== 0 ? "run" : "idle";

  const anim = animations[player.state];
  player.frameTimer += dt;
  if (player.frameTimer >= 1000 / anim.fps) {
    player.frame = (player.frame + 1) % anim.frames;
    player.frameTimer = 0;
  }

  camera.x = player.x - 80;

  clouds.forEach(c => {
    if (c.x - camera.x * 0.25 < -40) c.x += 400;
  });
}

/* =====================
   DRAW
===================== */
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawSky();
  clouds.forEach(drawCloud);
  trees.forEach(drawTree);
  drawGrass();
  drawNoob(player.frame);
}

/* =====================
   LOOP
===================== */
let last = 0;
function loop(t) {
  const dt = t - last;
  last = t;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);
</script>

</body>
</html>
