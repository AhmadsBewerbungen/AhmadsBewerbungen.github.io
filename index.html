<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Retro Noob</title>
<style>
  body {
    margin: 0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  canvas {
    image-rendering: pixelated;
    border: 4px solid #000;
    background: #87ceeb;
  }
</style>
</head>
<body>

<canvas id="game" width="320" height="180"></canvas>

<script>
/* =====================
   SETUP
   ===================== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const SCALE = 3;
canvas.style.width = canvas.width * SCALE + "px";
canvas.style.height = canvas.height * SCALE + "px";

const GROUND_Y = 140;
const GRAVITY = 0.35;

const keys = {};
addEventListener("keydown", e => keys[e.key] = true);
addEventListener("keyup", e => keys[e.key] = false);

/* =====================
   CAMERA
   ===================== */
const camera = { x: 0 };

/* =====================
   PLAYER
   ===================== */
const player = {
  x: 40,
  y: GROUND_Y,
  vx: 0,
  vy: 0,
  w: 24,
  h: 26,
  facing: 1,
  state: "idle",
  frame: 0,
  frameTimer: 0
};

/* 5 frames each */
const animations = {
  idle: { frames: 5, fps: 12 },
  run:  { frames: 5, fps: 16 },
  jump: { frames: 5, fps: 8 }
};

/* =====================
   BACKGROUND
   ===================== */
const clouds = [
  { x: 30, y: 25 },
  { x: 140, y: 35 },
  { x: 260, y: 20 }
];

const trees = [
  { x: 80 },
  { x: 160 },
  { x: 240 },
  { x: 320 }
];

/* =====================
   DRAW NOOB (RETRO)
   ===================== */
function drawNoob(frame) {
  const px = Math.floor(player.x - camera.x);
  const py = Math.floor(player.y - player.h);

  ctx.save();
  ctx.translate(px + player.w / 2, 0);
  ctx.scale(player.facing, 1);
  ctx.translate(-px - player.w / 2, 0);

  const bob =
    player.state === "idle"
      ? Math.sin(frame * 0.6) * 1
      : 0;

  const runSwing =
    player.state === "run"
      ? Math.sin(frame) * 2
      : 0;

  /* HEAD */
  ctx.fillStyle = "#ffd800";
  ctx.fillRect(px + 3, py - 4 + bob, 18, 18);

  ctx.fillStyle = "#e6c200";
  ctx.fillRect(px + 12, py + 6 + bob, 9, 8);

  ctx.fillStyle = "#ffef66";
  ctx.fillRect(px + 4, py - 3 + bob, 6, 4);

  ctx.strokeStyle = "#000";
  ctx.strokeRect(px + 3, py - 4 + bob, 18, 18);

  /* FACE */
  ctx.fillStyle = "#000";
  ctx.fillRect(px + 8,  py + 3 + bob, 2, 2);
  ctx.fillRect(px + 14, py + 3 + bob, 2, 2);
  ctx.fillRect(px + 9,  py + 8 + bob, 6, 1);
  ctx.fillRect(px + 8,  py + 7 + bob, 1, 1);
  ctx.fillRect(px + 15, py + 7 + bob, 1, 1);

  /* BODY */
  ctx.fillStyle = "#1e90ff";
  ctx.fillRect(px + 9, py + 14, 6, 6);
  ctx.strokeRect(px + 9, py + 14, 6, 6);

  /* ARMS */
  ctx.fillStyle = "#ffd800";
  ctx.fillRect(px + 5,  py + 14 + runSwing, 3, 6);
  ctx.fillRect(px + 16, py + 14 - runSwing, 3, 6);

  /* LEGS */
  ctx.fillStyle = "#000";
  ctx.fillRect(px + 9,  py + 20 + runSwing, 2, 4);
  ctx.fillRect(px + 13, py + 20 - runSwing, 2, 4);

  ctx.restore();
}

/* =====================
   DRAW WORLD
   ===================== */
function drawGrass() {
  ctx.fillStyle = "#228b22";
  ctx.fillRect(0, GROUND_Y, canvas.width, 40);

  ctx.fillStyle = "#1b6b1b";
  for (let i = 0; i < canvas.width; i += 4) {
    ctx.fillRect(i, GROUND_Y - 2, 2, 2);
  }
}

function drawCloud(c) {
  const x = c.x - camera.x * 0.3;
  ctx.fillStyle = "#fff";
  ctx.fillRect(x, c.y, 16, 6);
  ctx.fillRect(x + 4, c.y - 4, 12, 6);
}

function drawTree(t) {
  const x = t.x - camera.x * 0.5;
  ctx.fillStyle = "#8b4513";
  ctx.fillRect(x + 6, GROUND_Y - 14, 4, 14);
  ctx.fillStyle = "#2e8b57";
  ctx.fillRect(x, GROUND_Y - 24, 16, 10);
}

/* =====================
   UPDATE
   ===================== */
function update(dt) {
  player.vx = 0;

  if (keys["ArrowLeft"] || keys["a"]) {
    player.vx = -1.6;
    player.facing = -1;
  }
  if (keys["ArrowRight"] || keys["d"]) {
    player.vx = 1.6;
    player.facing = 1;
  }

  if ((keys[" "] || keys["ArrowUp"]) && player.vy === 0) {
    player.vy = -5.5;
  }

  player.vy += GRAVITY;

  player.x += player.vx;
  player.y += player.vy;

  /* SOLID GROUND (NO FALLING THROUGH) */
  if (player.y > GROUND_Y) {
    player.y = GROUND_Y;
    player.vy = 0;
  }

  /* STATE */
  if (player.vy !== 0) player.state = "jump";
  else if (player.vx !== 0) player.state = "run";
  else player.state = "idle";

  /* ANIMATION */
  const anim = animations[player.state];
  player.frameTimer += dt;
  if (player.frameTimer >= 1000 / anim.fps) {
    player.frame = (player.frame + 1) % anim.frames;
    player.frameTimer = 0;
  }

  /* CAMERA */
  camera.x = player.x - 80;

  /* CLOUD LOOP */
  clouds.forEach(c => {
    if (c.x - camera.x * 0.3 < -40) {
      c.x += 400;
    }
  });
}

/* =====================
   DRAW
   ===================== */
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  clouds.forEach(drawCloud);
  trees.forEach(drawTree);
  drawGrass();
  drawNoob(player.frame);
}

/* =====================
   LOOP
   ===================== */
let last = 0;
function loop(t) {
  const dt = t - last;
  last = t;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);
</script>

</body>
</html>
