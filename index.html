<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Pixel Noob Runner</title>
<style>
  body {
    margin: 0;
    background: #87ceeb;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  canvas {
    image-rendering: pixelated;
    border: 4px solid #000;
  }
</style>
</head>
<body>

<canvas id="game" width="320" height="180"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const SCALE = 3;
canvas.style.width = canvas.width * SCALE + "px";
canvas.style.height = canvas.height * SCALE + "px";

const GRAVITY = 0.25;
const GROUND_Y = 140;

const keys = {};
window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

const player = {
  x: 40,
  y: GROUND_Y,
  vx: 0,
  vy: 0,
  w: 24,
  h: 24,
  facing: 1,
  state: "idle",
  frame: 0,
  frameTimer: 0
};

// Animation definitions
const animations = {
  idle: { frames: 4, fps: 12 },
  run:  { frames: 6, fps: 16 },
  jump: { frames: 1, fps: 1 }
};

function drawPixelCircle(cx, cy, r, color) {
  ctx.fillStyle = color;
  for (let y = -r; y <= r; y++) {
    for (let x = -r; x <= r; x++) {
      if (x*x + y*y <= r*r) {
        ctx.fillRect(cx + x, cy + y, 1, 1);
      }
    }
  }
}

// Draw player sprite per frame
function drawNoob(frame) {
  const px = Math.floor(player.x);
  const py = Math.floor(player.y - player.h);

  ctx.save();
  ctx.translate(px + player.w / 2, 0);
  ctx.scale(player.facing, 1);
  ctx.translate(-px - player.w / 2, 0);

  // Head bob for idle
  const headBob = player.state === "idle"
    ? Math.sin(frame * 0.8) * 1
    : 0;

  // Body
  ctx.fillStyle = "#1e90ff";
  ctx.fillRect(px + 7, py + 14, 10, 8);

  // Arms (run swing)
  ctx.fillStyle = "#ffd800";
  const armOffset = player.state === "run"
    ? Math.sin(frame) * 2
    : 0;
  ctx.fillRect(px + 4, py + 15 + armOffset, 3, 6);
  ctx.fillRect(px + 17, py + 15 - armOffset, 3, 6);

  // Legs
  ctx.fillStyle = "#000";
  if (player.state === "run") {
    ctx.fillRect(px + 8, py + 22 + Math.sin(frame)*2, 3, 4);
    ctx.fillRect(px + 13, py + 22 - Math.sin(frame)*2, 3, 4);
  } else {
    ctx.fillRect(px + 8, py + 22, 3, 4);
    ctx.fillRect(px + 13, py + 22, 3, 4);
  }

  // Head (big & round)
  drawPixelCircle(px + 12, py + 8 + headBob, 6, "#ffd800");

  // Face
  ctx.fillStyle = "#000";
  ctx.fillRect(px + 9, py + 7 + headBob, 1, 1);
  ctx.fillRect(px + 14, py + 7 + headBob, 1, 1);
  ctx.fillRect(px + 10, py + 10 + headBob, 5, 1);

  ctx.restore();
}

const clouds = [
  { x: 40, y: 25 },
  { x: 140, y: 35 },
  { x: 240, y: 20 }
];

function drawCloud(c) {
  ctx.fillStyle = "#fff";
  ctx.fillRect(c.x, c.y, 16, 6);
  ctx.fillRect(c.x + 4, c.y - 4, 12, 6);
  ctx.fillRect(c.x + 8, c.y + 2, 14, 6);
}

function drawGrass() {
  ctx.fillStyle = "#228b22";
  ctx.fillRect(0, GROUND_Y, canvas.width, 40);
  ctx.fillStyle = "#1b6b1b";
  for (let i = 0; i < canvas.width; i += 4) {
    ctx.fillRect(i, GROUND_Y - 2, 2, 2);
  }
}

function update(dt) {
  player.vx = 0;

  if (keys["ArrowLeft"] || keys["a"]) {
    player.vx = -1.5;
    player.facing = -1;
  }
  if (keys["ArrowRight"] || keys["d"]) {
    player.vx = 1.5;
    player.facing = 1;
  }

  if ((keys["ArrowUp"] || keys["w"] || keys[" "]) && player.y >= GROUND_Y) {
    player.vy = -5;
  }

  player.vy += GRAVITY;
  player.x += player.vx;
  player.y += player.vy;

  if (player.y >= GROUND_Y) {
    player.y = GROUND_Y;
    player.vy = 0;
  }

  // State machine
  if (player.y < GROUND_Y) {
    player.state = "jump";
  } else if (player.vx !== 0) {
    player.state = "run";
  } else {
    player.state = "idle";
  }

  // Animation timing
  const anim = animations[player.state];
  player.frameTimer += dt;
  if (player.frameTimer >= 1000 / anim.fps) {
    player.frame = (player.frame + 1) % anim.frames;
    player.frameTimer = 0;
  }

  // Clouds
  clouds.forEach(c => {
    c.x -= 0.2;
    if (c.x < -30) c.x = canvas.width + 30;
  });
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  clouds.forEach(drawCloud);
  drawGrass();
  drawNoob(player.frame);
}

let last = 0;
function loop(t) {
  const dt = t - last;
  last = t;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);
</script>

</body>
</html>
